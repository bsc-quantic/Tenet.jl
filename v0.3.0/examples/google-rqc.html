<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Google&#39;s Quantum Advantage experiment ¬∑ Tenet.jl</title><meta name="title" content="Google&#39;s Quantum Advantage experiment ¬∑ Tenet.jl"/><meta property="og:title" content="Google&#39;s Quantum Advantage experiment ¬∑ Tenet.jl"/><meta property="twitter:title" content="Google&#39;s Quantum Advantage experiment ¬∑ Tenet.jl"/><meta name="description" content="Documentation for Tenet.jl."/><meta property="og:description" content="Documentation for Tenet.jl."/><meta property="twitter:description" content="Documentation for Tenet.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../assets/youtube.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Tenet.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Tenet.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Tenet.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../tensors.html">Tensors</a></li><li><span class="tocitem">Tensor Networks</span><ul><li><a class="tocitem" href="../tensor-network.html">Introduction</a></li><li><a class="tocitem" href="../contraction.html">Contraction</a></li><li><a class="tocitem" href="../transformations.html">Transformations</a></li><li><a class="tocitem" href="../visualization.html">Visualization</a></li></ul></li><li><span class="tocitem">Quantum Tensor Networks</span><ul><li><a class="tocitem" href="../quantum/index.html">Introduction</a></li><li><a class="tocitem" href="../quantum/mps.html">Matrix Product States (MPS)</a></li><li><a class="tocitem" href="../quantum/peps.html">Projected Entangled Pair States (PEPS)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href="google-rqc.html">Google&#39;s Quantum Advantage experiment</a></li><li><a class="tocitem" href="ad-tn.html">Automatic Differentiation on Tensor Network contraction</a></li></ul></li><li><a class="tocitem" href="../alternatives.html">Alternatives</a></li><li><a class="tocitem" href="../references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="google-rqc.html">Google&#39;s Quantum Advantage experiment</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="google-rqc.html">Google&#39;s Quantum Advantage experiment</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bsc-quantic/Tenet.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bsc-quantic/Tenet.jl/blob/master/docs/src/examples/google-rqc.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Google&#39;s-Quantum-Advantage-experiment"><a class="docs-heading-anchor" href="#Google&#39;s-Quantum-Advantage-experiment">Google&#39;s Quantum Advantage experiment</a><a id="Google&#39;s-Quantum-Advantage-experiment-1"></a><a class="docs-heading-anchor-permalink" href="#Google&#39;s-Quantum-Advantage-experiment" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Dependencies üì¶</header><div class="admonition-body"><p>This example uses <code>QuacIO</code> and <code>EinExprs</code> in combination with <code>Tenet</code>. Both packages can be found in <a href="https://github.com/bsc-quantic/Registry">Quantic&#39;s registry</a> and can be installed in Pkg mode.</p><pre><code class="language-julia hljs">add QuacIO EinExprs</code></pre><p>It also requires the circuit in <code>sycamore_m53_d10.qasm</code> file that can be found in <a href="sycamore_53_10_0.qasm">here</a>. This is a shorter version of the real circuit used for the experiment.</p></div></div><p>In 2019, Google rushed to claim <em>quantum advantage</em><sup class="footnote-reference"><a id="citeref-supremacy" href="#footnote-supremacy">[supremacy]</a></sup> for the first time ever <a href="../references.html#arute2019quantum">(Arute *et al.*, 2019)</a><a href="../references.html#villalonga2020establishing">(Villalonga *et al.*, 2020)</a>. The article was highly criticized and one year later, it was disproved <a href="../references.html#gray2021hyper">(Gray and Kourtis, 2021)</a> by developing a better heuristic search for contraction path which provided a <span>$\times 10^4$</span> speedup.</p><p>Since then, several teams and companies have come and go, proposing and disproving several experiments. But in this example, we focus on the original Google experiment.</p><p>In short, the experiment consisted on sampling Random Quantum Circuits (RQC). The state of the systems after these circuits follow a distribution similar, but <strong>not equal</strong> to the uniform distribution. Due to noise and decoherence, the fidelity of quantum chips decrease with the circuit depth. The complexity of contracting tensor networks grows with the circuit depth, but due to the fidelity of the physical realization being small, a very rough approximation can be used. In the case of Google, they used <em>tensor slicing</em> for projecting some expensive to contract indices. Since the contribution of each quantum path is guessed to be similar, each slice should contribute a similar part, and by taking the same percentage of slices as the fidelity of the quantum experiment, we obtain a result with a similar fidelity. If you want to read more on the topic, check out <a href="../references.html#boixo2018characterizing">(Boixo *et al.*, 2018)</a>,<a href="../references.html#markov2018quantum">(Markov *et al.*, 2018)</a>.</p><p>Thanks to <code>Tenet</code>&#39;s much cared design, the experiment can be replicated conceptually in less than 20loc.</p><pre><code class="language-julia hljs">using QuacIO
using Tenet

_sites = [5, 6, 14, 15, 16, 17, 24, 25, 26, 27, 28, 32, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 61, 62, 63, 64, 65, 66, 67, 72, 73, 74, 75, 76, 83, 84, 85, 94];

# load circuit and convert to `TensorNetwork`
circuit = QuacIO.parse(joinpath(@__DIR__, &quot;sycamore_53_10_0.qasm&quot;), format = QuacIO.Qflex(), sites = _sites);
tn = TensorNetwork(circuit)
tn = view(tn, [i =&gt; 1 for i in inds(tn, set=:open)]...)</code></pre><img src="google-rqc-bb96a412.svg" alt="Example block output"/><p>In order to aid the contraction path optimization, we shrink the search space by using local transformations.</p><pre><code class="language-julia hljs"># simplify Tensor Network by preemptively contracting trivial cases
tn = transform(tn, Tenet.RankSimplification)</code></pre><img src="google-rqc-dccd9458.svg" alt="Example block output"/><p>Contraction path optimization is the focus of the <a href="https://github.com/bsc-quantic/EinExprs.jl"><code>EinExprs</code></a> package. For this example, we will use the <code>Greedy</code> algorithm which doesn&#39;t yield the optimal path but it&#39;s fast and reproducible.</p><pre><code class="language-julia hljs">using EinExprs
path = einexpr(tn, optimizer = Greedy)</code></pre><img src="google-rqc-b0c1a5fa.svg" alt="Example block output"/><p>Then, the indices to be sliced have to be selected. <code>EinExprs</code> provides us with the <code>findslices</code> algorithm (based in the <code>SliceFinder</code> algorithm of <a href="../references.html#cotengra">(Gray, 2021)</a>) to suggest candidate indices for slicing.</p><pre><code class="language-julia hljs">cuttings = [[i =&gt; dim for dim in 1:size(tn,i)] for i in findslices(FlopsScorer(), path, slices=100)]</code></pre><p>Finally, the contraction of slices is parallelized using distributed workers and each contribution is summed to <code>result</code>.</p><pre><code class="language-julia hljs">using Distributed
using Iterators: product

addprocs(10)

@everywhere using Tenet, EinExprs
@everywhere tn = $tn
@everywhere path = $path

result = @distributed (+) for proj_inds in product(cuttings...)
    slice = view(tn, proj_inds...)

    for indices in contractorder(path)
        contract!(slice, indices)
    end

    tensors(slice) |&gt; only
end</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-supremacy"><a class="tag is-link" href="#citeref-supremacy">supremacy</a>The first used term was <em>quantum supremacy</em> although the community transitioned to <em>quantum advantage</em> due to political reasons. However, Google now uses the term <em>beyond classical</em>. It is then not uncommon to find different terms to refer to the same thing: the moment in which quantum computers surpass classical computers on solving some problem.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quantum/peps.html">¬´ Projected Entangled Pair States (PEPS)</a><a class="docs-footer-nextpage" href="ad-tn.html">Automatic Differentiation on Tensor Network contraction ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.0 on <span class="colophon-date" title="Sunday 17 September 2023 22:32">Sunday 17 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
